<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ECALELF: EnergyScaleCorrection_class Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>EnergyScaleCorrection_class Class Reference</h1><!-- doxytag: class="EnergyScaleCorrection_class" -->
<p>Read and get energy scale and smearings from .dat files.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;Calibration/ZFitter/src/EnergyScaleCorrection_class.cc&gt;</code></p>

<p><a href="../../d8/dfc/classEnergyScaleCorrection__class-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aad245a5cb7b37ae9806faec05af62911"></a><!-- doxytag: member="EnergyScaleCorrection_class::EnergyScaleCorrection_class" ref="aad245a5cb7b37ae9806faec05af62911" args="(TString correctionFileName, TString smearingFileName=&quot;&quot;)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dfa/classEnergyScaleCorrection__class.html#aad245a5cb7b37ae9806faec05af62911">EnergyScaleCorrection_class</a> (TString correctionFileName, TString smearingFileName=&quot;&quot;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">constructor with correction file names <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acc98316da39ff25e1266e901d60e70fc"></a><!-- doxytag: member="EnergyScaleCorrection_class::ScaleCorrection" ref="acc98316da39ff25e1266e901d60e70fc" args="(int runNumber, bool isEBEle, double R9Ele, double etaSCEle, double EtEle, int nPV, float nPVmean=0)" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dfa/classEnergyScaleCorrection__class.html#acc98316da39ff25e1266e901d60e70fc">ScaleCorrection</a> (int runNumber, bool isEBEle, double R9Ele, double etaSCEle, double EtEle, int nPV, float nPVmean=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">method to get energy scale corrections <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abff5b2407a3807ab9582526aaaf8afe2"></a><!-- doxytag: member="EnergyScaleCorrection_class::getSmearingRho" ref="abff5b2407a3807ab9582526aaaf8afe2" args="(int runNumber, float energy, bool isEBEle, float R9Ele, float etaSCEle)" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dfa/classEnergyScaleCorrection__class.html#abff5b2407a3807ab9582526aaaf8afe2">getSmearingRho</a> (int runNumber, float energy, bool isEBEle, float R9Ele, float etaSCEle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">public for sigmaE estimate <br/></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a874b4b94c985ed18feeaaa45055e7c5e"></a><!-- doxytag: member="EnergyScaleCorrection_class::ReadFromFile" ref="a874b4b94c985ed18feeaaa45055e7c5e" args="(TString filename)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dfa/classEnergyScaleCorrection__class.html#a874b4b94c985ed18feeaaa45055e7c5e">ReadFromFile</a> (TString filename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">category "runNumber" runMin runMax deltaP err_deltaP <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dfa/classEnergyScaleCorrection__class.html#a077e9fcfdd95d4c4a645944a05c4cf4e">ReadSmearingFromFile</a> (TString filename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File structure: category constTerm alpha;.  <a href="#a077e9fcfdd95d4c4a645944a05c4cf4e"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Read and get energy scale and smearings from .dat files. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a077e9fcfdd95d4c4a645944a05c4cf4e"></a><!-- doxytag: member="EnergyScaleCorrection_class::ReadSmearingFromFile" ref="a077e9fcfdd95d4c4a645944a05c4cf4e" args="(TString filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EnergyScaleCorrection_class::ReadSmearingFromFile </td>
          <td>(</td>
          <td class="paramtype">TString&nbsp;</td>
          <td class="paramname"> <em>filename</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>File structure: category constTerm alpha;. </p>
<p>File structure: EBlowEtaBad8TeV 0 0.0 1.0 -999. 0.94 -999999 999999 6.73 0. 7.7e-3 6.32e-4 0.00 0.16 EBlowEtaGold8TeV 0 0.0 1.0 0.94 999. -999999 999999 6.60 0. 7.4e-3 6.50e-4 0.00 0.16 EBhighEtaBad8TeV 0 1.0 1.5 -999. 0.94 -999999 999999 6.73 0. 1.26e-2 1.03e-3 0.00 0.07 EBhighEtaGold8TeV 0 1.0 1.5 0.94 999. -999999 999999 6.52 0. 1.12e-2 1.32e-3 0.00 0.22 ################################################################################################## EElowEtaBad8TeV 0 1.5 2.0 -999. 0.94 -999999 999999 0. 0. 1.98e-2 3.03e-3 0. 0. EElowEtaGold8TeV 0 1.5 2.0 0.94 999. -999999 999999 0. 0. 1.63e-2 1.22e-3 0. 0. EEhighEtaBad8TeV 0 2.0 3.0 -999. 0.94 -999999 999999 0. 0. 1.92e-2 9.22e-4 0. 0. EEhighEtaGold8TeV 0 2.0 3.0 0.94 999. -999999 999999 0. 0. 1.86e-2 7.81e-4 0. 0. ################################################################################################## </p>

<p><div class="fragment"><pre class="fragment"><a name="l00266"></a>00266                                                                       {
<a name="l00267"></a>00267   std::cout &lt;&lt; <span class="stringliteral">&quot;[STATUS] Reading smearing values from file: &quot;</span> &lt;&lt; filename &lt;&lt; std::endl;
<a name="l00268"></a>00268   ifstream f_in(filename);
<a name="l00269"></a>00269   <span class="keywordflow">if</span>(!f_in.good()){
<a name="l00270"></a>00270     std::cerr &lt;&lt; <span class="stringliteral">&quot;[ERROR] file &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; not readable&quot;</span> &lt;&lt; std::endl;
<a name="l00271"></a>00271     exit(1);
<a name="l00272"></a>00272   }
<a name="l00273"></a>00273   
<a name="l00274"></a>00274   <span class="keywordtype">int</span> runMin=0, runMax=900000;
<a name="l00275"></a>00275   <span class="keywordtype">int</span> unused=0;
<a name="l00276"></a>00276   TString category, region2;
<a name="l00277"></a>00277   <span class="comment">//double smearing, err_smearing;</span>
<a name="l00278"></a>00278   <span class="keywordtype">double</span> rho, phi, Emean, constTerm, alpha, err_rho, err_phi, err_Emean, err_alpha=0., err_constTerm=0.;
<a name="l00279"></a>00279   <span class="keywordtype">double</span> etaMin, etaMax, r9Min, r9Max;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281   <span class="keywordtype">int</span> format=0; 
<a name="l00282"></a>00282   <span class="keywordflow">while</span>(f_in.peek()!=EOF &amp;&amp; f_in.good()){
<a name="l00283"></a>00283     <span class="keywordflow">if</span>(f_in.peek()==10){ <span class="comment">// 10 = \n</span>
<a name="l00284"></a>00284       f_in.get(); 
<a name="l00285"></a>00285       <span class="keywordflow">continue</span>;
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288     <span class="keywordflow">if</span>(f_in.peek() == 35){ <span class="comment">// 35 = #</span>
<a name="l00289"></a>00289       f_in.ignore(1000,10); <span class="comment">// ignore the rest of the line until \n</span>
<a name="l00290"></a>00290       <span class="keywordflow">continue</span>;
<a name="l00291"></a>00291     }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293     <span class="keywordflow">if</span>(format==0){
<a name="l00294"></a>00294       std::string line;
<a name="l00295"></a>00295       std::getline(f_in, line);
<a name="l00296"></a>00296       std::istringstream s_in(line);
<a name="l00297"></a>00297       s_in &gt;&gt; category &gt;&gt; unused &gt;&gt; etaMin &gt;&gt; etaMax 
<a name="l00298"></a>00298            &gt;&gt; r9Min &gt;&gt; r9Max &gt;&gt; runMin &gt;&gt; runMax 
<a name="l00299"></a>00299            &gt;&gt; Emean &gt;&gt; err_Emean 
<a name="l00300"></a>00300            &gt;&gt; rho &gt;&gt; err_rho &gt;&gt; phi &gt;&gt; err_phi;
<a name="l00301"></a>00301       <span class="keywordflow">if</span>(s_in.eof()){ <span class="comment">// this is not the globe format but the ECALELF format</span>
<a name="l00302"></a>00302         std::cout &lt;&lt; <span class="stringliteral">&quot;[INFO] format=2&quot;</span> &lt;&lt; std::endl;
<a name="l00303"></a>00303         format=2;
<a name="l00304"></a>00304         s_in &gt;&gt; category &gt;&gt; constTerm &gt;&gt; alpha;
<a name="l00305"></a>00305         AddSmearing(category, runMin, runMax, constTerm,  err_constTerm, alpha, err_alpha, Emean, err_Emean);
<a name="l00306"></a>00306       }<span class="keywordflow">else</span>{
<a name="l00307"></a>00307         format=1;
<a name="l00308"></a>00308         std::cout &lt;&lt; <span class="stringliteral">&quot;[INFO] format=1&quot;</span> &lt;&lt; std::endl;
<a name="l00309"></a>00309         <span class="keywordflow">if</span>(Emean!=0){
<a name="l00310"></a>00310           constTerm=rho*sin(phi);
<a name="l00311"></a>00311           alpha=rho*Emean*cos(phi);
<a name="l00312"></a>00312         }<span class="keywordflow">else</span>{
<a name="l00313"></a>00313           alpha=0;
<a name="l00314"></a>00314           constTerm=rho;
<a name="l00315"></a>00315         }
<a name="l00316"></a>00316         
<a name="l00317"></a>00317         AddSmearing(category, runMin, runMax, constTerm,  err_constTerm, alpha, err_alpha, Emean, err_Emean);
<a name="l00318"></a>00318         
<a name="l00319"></a>00319       }
<a name="l00320"></a>00320     }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(format==1){
<a name="l00321"></a>00321       f_in &gt;&gt; category &gt;&gt; unused &gt;&gt; etaMin &gt;&gt; etaMax &gt;&gt; r9Min &gt;&gt; r9Max &gt;&gt; runMin &gt;&gt; runMax &gt;&gt; 
<a name="l00322"></a>00322         Emean &gt;&gt; err_Emean &gt;&gt; 
<a name="l00323"></a>00323         rho &gt;&gt; err_rho &gt;&gt; phi &gt;&gt; err_phi;
<a name="l00324"></a>00324       <span class="keywordflow">if</span>(Emean!=0){
<a name="l00325"></a>00325         constTerm=rho*sin(phi);
<a name="l00326"></a>00326         alpha=rho*Emean*cos(phi);
<a name="l00327"></a>00327       }<span class="keywordflow">else</span>{
<a name="l00328"></a>00328         alpha=0;
<a name="l00329"></a>00329         constTerm=rho;
<a name="l00330"></a>00330       }
<a name="l00331"></a>00331       
<a name="l00332"></a>00332       AddSmearing(category, runMin, runMax, constTerm,  err_constTerm, alpha, err_alpha, Emean, err_Emean);
<a name="l00333"></a>00333       
<a name="l00334"></a>00334     }<span class="keywordflow">else</span>{
<a name="l00335"></a>00335       f_in &gt;&gt; category &gt;&gt; constTerm &gt;&gt; alpha;
<a name="l00336"></a>00336       AddSmearing(category, runMin, runMax, constTerm,  err_constTerm, alpha, err_alpha, Emean, err_Emean);
<a name="l00337"></a>00337     } 
<a name="l00338"></a>00338 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00339"></a>00339 <span class="preprocessor"></span>    std::cout &lt;&lt; category &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; etaMin &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; etaMax &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; r9Min &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; r9Max &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; runMin &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; runMax &lt;&lt; <span class="stringliteral">&quot;\tEmean=&quot;</span> &lt;&lt; Emean &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; rho &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; phi &lt;&lt; std::endl;
<a name="l00340"></a>00340 <span class="preprocessor">#endif</span>
<a name="l00341"></a>00341 <span class="preprocessor"></span>  }
<a name="l00342"></a>00342   
<a name="l00343"></a>00343   f_in.close();
<a name="l00344"></a>00344   <span class="comment">//  runCorrection_itr=runMin_map.begin();</span>
<a name="l00345"></a>00345   
<a name="l00346"></a>00346   noSmearings=<span class="keyword">false</span>;
<a name="l00347"></a>00347   
<a name="l00348"></a>00348   <span class="keywordflow">return</span>;
<a name="l00349"></a>00349 }
</pre></div></p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ZFitter/interface/EnergyScaleCorrection_class.h</li>
<li>ZFitter/src/EnergyScaleCorrection_class.cc</li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 16 Apr 2014 for ECALELF by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
