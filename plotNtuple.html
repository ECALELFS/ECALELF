<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ECALELF: How to make plots using ECALELF ntuples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="plotNtuple">How to make plots using ECALELF ntuples </a></h1><p>#======================================== Working with ntuples: how to # play by hand with ntuples</p>
<p>If you are interested only in using the fit for validations you can skip this paragraphs and go directly to "RERECO VALIDATION instructions"</p>
<p>The .dat config file keeping the list of ntuples can be modified according to the needs adding or commenting unuseful ntuples or friend trees. It's then important to have a simple way to merge the trees in order to be able to manipulate, scan and plot variables from the ntuples. The ZFitter/script/GenRootChain.sh has been designed for this.</p>
<p>running the command: ./script/GenRootChain.sh -f data/validation/myConfigFile.dat in the tmp/ the s_chain.root, d_chain.root load.C are created for MC and data respectively. The .root files have the TChains already defined, merging the files with the same treeName in the config file and adding the friends properly. Due to a bug in ROOT in order to properly load the files the load.C script is created.</p>
<p>To work with ntuples you can do (see pratical example below): root -l tmp/d_chain.root tmp/s_chain.root tmp/load.C data -&gt; Draw("*"); signalA -&gt; Draw("*");</p>
<p>NB: Please check in the load.C file the correct assignment of the tree pointer to the correct file.</p>
<p>#============================== Data/MC plots A standard function for data/MC plots have been prepared and is available in macro/PlotDataMC.C</p>
<p>In the following you can find an example of production of data/MC plots with a config file with 22Jan rereco data, run dependent MC (three samples with different generators: s1, s2, s3) ./script/GenRootChain.sh -f data/validation/22Jan2012-runDepMCAll_v2.dat root -l -b -q tmp/d_chain.root tmp/s1_chain.root tmp/s2_chain.root tmp/load.C macro/standardDataMC.C</p>
<p>The load.C script is commented below: { gROOT-&gt;ProcessLine(".L macro/PlotDataMC.C+"); // -&gt; functions for data/MC plots gROOT-&gt;ProcessLine(".L src/setTDRStyle.C"); gROOT-&gt;ProcessLine(".L macro/addChainWithFriends.C+"); // -&gt; functions to work around ROOT bugs in friend treatment</p>
<p>setTDRStyle1();</p>
<p>TChain *data = (TChain *) _file0-&gt;Get("selected"); // -&gt; pointers to samples TChain *signalA = (TChain *) _file1-&gt;Get("selected"); // -&gt; pointers to samples TChain *signalB = (TChain *) _file2-&gt;Get("selected"); // -&gt; pointers to samples TChain *signalC = (TChain *) _file3-&gt;Get("selected"); // -&gt; pointers to samples</p>
<p>ReassociateFriends(_file0, data); // -&gt; functions to correct associate the friends to their main trees ReassociateFriends(_file1, signalA); // -&gt; functions to correct associate the friends to their main trees ReassociateFriends(_file2, signalB); // -&gt; functions to correct associate the friends to their main trees ReassociateFriends(_file3, signalC); // -&gt; functions to correct associate the friends to their main trees</p>
<p>TDirectory *curDir = new TDirectory("curDir",""); curDir-&gt;cd();</p>
<p>TString outputPath="tmp/";</p>
<p>look at standardDataMC.C for some examples }</p>
<p>The standardDataMC.C example: { std::vector&lt;TString&gt; mcLabel_vec; // create a vector of labels for the MC samples mcLabel_vec.push_back("Madgraph"); mcLabel_vec.push_back("Powheg"); mcLabel_vec.push_back("Sherpa");</p>
<p>MakeChainVector(signalA,signalB,signalC)</p>
<p>c = PlotDataMCs(data, // pointer to data chain MakeChainVector(signalA,signalB,signalC), // creates a vector of chains for MCs "etaEle", // variable to be plotted "(100,-2.5,2.5)", // binning of x axis "eleID_loose-trigger-noPF-Et_25", // stream based selection with ECALELF convention -&gt; a specific class takes care in parsing the string and provide the selections cuts "", // additional selection string in standard ROOT syntax, "Data", // label for data in Legend mcLabel_vec, // vector of strings for MC labels in legend "#eta", // x axis title "", false, // do plot in log scale true // reweight MC for PU ); // use r9weight c-&gt;SaveAs(outputPath+"etaEle-r9reweighted-Et_25.eps"); c-&gt;SaveAs(outputPath+"etaEle-r9reweighted-Et_25.C"); delete c; } </p>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 23 Jun 2014 for ECALELF by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
