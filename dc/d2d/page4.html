<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>ECALELF: How to work with ECALELF ntuples</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ECALELF
   &#160;<span id="projectnumber">NAN</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">How to work with ECALELF ntuples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Go to the Calibration/ZFitter directory and compile it: </p>
<div class="fragment"><div class="line">make</div>
</div><!-- fragment --><p>Calibration/ZFitter will be your working directory now on.</p>
<p>Two methods are used in order to evaluate the energy scale and resolution:</p>
<ul>
<li>fitMethod: consists in fitting the Z lineshape with a parametric model This method gives an estimate of the Z peak and width separately for data and MC. On the other hand the energy scale and energy resolution are estimated for electrons belonging to the same di-electron categories. With this method the energy scale and resolution are measured for di-electron categories.</li>
<li>smearingMethod: consists in using the Z lineshape from MC after the scaling and smearing of the single electron energy. The energy scale and smearing is applied to the single electron energy before calculating the invariant mass, so they are directly the single electron energy scale and smearings.</li>
</ul>
<p>The methods are implemented in separate classes, there is only one executable (./bin/ZFitter.exe) that with command line options can run the fitMethod or the smearingMethod.</p>
<p>The inputs to the ZFitter program are given in the form of:</p>
<ul>
<li>configuration files (.dat)</li>
<li>command line options</li>
</ul>
<p>The configuration files are described in: <a class="el" href="../../d8/d25/ZFitterConfigFiles.html">Config files syntax and generation</a></p>
<p>The ntuple structure and logic is explained in <a class="el" href="../../db/d60/NtupleStructure.html">Ntuple content and logic of use</a></p>
<p>How to generate the PUDumper.root files and use them: <a class="el" href="../../d5/d35/pudumper.html">Generating PUDumper.root files</a></p>
<p>How to generate the PUDumper.root files and use them: pudumper2</p>
<p>How to generate the PUDumper.root files and use them: <a class="el" href="../../db/d60/NtupleStructure.html">Ntuple content and logic of use</a></p>
<p><a class="el" href="../../d0/d2a/plotNtuple.html">How to make plots using ECALELF ntuples</a></p>
<p>page7 </p>
<pre class="fragment">#============================================================
The files containing the histograms for the PU reweight are
indicated with pileupHist as treeName and they are treated in a
different way. There must be only one pileupHist for d and one for s,
then the program calculates the weights for the MC, produces a
temporary file with just one tree containing the weights (pileupTree)
and it is added as friend to the chain of MC. You can also provide
directly the "temporary" root file indicating
s       pileupTree      file.root



Package content:
 - BW_CB_pdf_class
        Class providing a RooPdf correspoding to the convolution of a
        Breit-Wigner and Crystal Ball
 - Cruijff_pdf_class
        Class providing a RooPdf corresponding to a Cruijff function
        (Gaussian with exponential tails)
 - ElectronCategory_class
        Parser class for electron categorization providing TCuts for
        RooDataset 
 - ZFit_class 
        Class for fitting the Z lineshape from any RooAbsData 
 - ZFitter
        General program for Z fit (monitoring, calibration validation)

Input:
While the classes are almost generic and flexible, the ZFitter program
is thought to be used starting from ECALELF ntuples (ZNtuples).

 - data ntuples must contain:
        - a tree "selected"
 - mc ntuples must contain:
        - a tree "selected"
 - config file: see next section
 - run range config file:
        file containing a list of run ranges: every region will be
        checked in every run range in this file
 - category config file:
        file containing a list of regions (categories) for electrons
        it will be combined with the run range config file (if provided)
 - option:
        - global pt cut
        - selection
        - energy used for the invariant mass calculation (invMass_var)
        - (not implemented) bin/unbin/mixed: performe binned/unbinned fit or a mix
          version (unbinned for &lt; mixedSwitchValue events, binned otherwise) 
        - (not implemented) mixed switch value: 200 by default 
        - 

If no external PU reweight is provided and no tree containing the PU
reweight for the MC, the program reads the files, add all the data PU
histograms, add all the MC PU histograms, calculates the PU
reweight, produce a tree with the per event weight for the MC. 
Then add the tree with the PU weights to the MC chain as a friend
tree.
</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
