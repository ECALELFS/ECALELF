#Example on how to miscalibrate rec hits starting from rechits.


process ProcessOne = {
  #include "FWCore/MessageLogger/data/MessageLogger.cfi"

  service = MessageLogger {
     untracked vstring destinations = {"cout"}
     untracked PSet cout = {
       untracked  PSet default = { untracked int32 limit = 0 }
     }
  }

 #######################################################################################
# input
  # input module. assume root file contains EcalRecHits
  source = PoolSource 
  {
    # Number of events program should run
    untracked vstring fileNames = {
    '/store/unmerged/RelVal/2006/8/13/RelVal090SingleEPt35/GEN-SIM-DIGI-RECO/0005/36425AEE-1D2B-DB11-9742-00304885B014.root',
    '/store/unmerged/RelVal/2006/8/13/RelVal090SingleEPt35/GEN-SIM-DIGI-RECO/0005/C0944C24-1E2B-DB11-9A57-003048562896.root'
    }
    untracked int32 maxEvents = -1
  }

 #######################################################################################
include "RecoLocalCalo/EcalRecProducers/data/ecalLocalRecoSequence.cff"
    es_source = CaloMiscalibTools{
	untracked string fileNameBarrel = "miscalib_barrel_0fb-1.xml"
	}
    es_prefer = CaloMiscalibTools{}



module miscalrechit = EcalRecHitMiscalib {
    string ecalRecHitsProducer = "ecalRecHit"
    string barrelHitCollection = "EcalRecHitsEB"
    string endcapHitCollection = "EcalRecHitsEE"
    string RecalibBarrelHitCollection = "EcalRecHitsEB"
    string RecalibEndcapHitCollection = "EcalRecHitsEE"
}

include "RecoEcal/EgammaClusterProducers/data/ecalClusteringSequence.cff"  

replace hybridSuperClusters.ecalhitproducer = "miscalrechit"
replace correctedHybridSuperClusters.recHitProducer = "miscalrechit"

  module out = PoolOutputModule 
   {	
	untracked vstring outputCommands = 
	  {
	    "keep *"
	  }
     untracked string fileName = 'tbhits.root'
   }


  # analysis module for HV Scan
  module testMiscalibration = miscalibExample 
  {

   untracked string rootfile = "miscalibExample2.root"
   string correctedHybridSuperClusterProducer = "correctedHybridSuperClusters"
   string correctedHybridSuperClusterCollection = ""
   
  }

  path p = {miscalrechit, ecalClusteringSequence, testMiscalibration }
  endpath ep = { out }
}

